# python_wiki_parser
<b><h3>Тестовое задание на вакансию Back-end разработчик Python:</h3> </b>
<p></p>
<p>Требуется написать рекурсивный парсер википедии с журналированием на глубину до 6 страниц.  </p>
<p>Вся работа должна выполняться в асинхронной функции на  <b>python3.6 </b> или старше.</p>
<b><p>Вот примерный алгоритм работы   </p></b>
<ul>
 <li>1. Инициализировать eventloop;</li>
 <li>2. На вход асинхронной функции подать  <b>URL </b> одной страницы из Википедии;</li>
 <li>3. Подключиться к БД и записать URL текущей страницы; </li>
 <li>4. Скачать страницу по URL и извлечь все ссылки на другие статьи по шаблону  <b>&lt;a href="#(*)"> </b>,</li> 
 <b><p>(найдете другие способы получить эти ссылки –  <b>пожалуйста </b>);</p></b>
 <li>5. По каждой найденной ссылке:
   <ul>
    <li>записать URL ссылки в таблицу страниц, + в таблицу связей записать связанность страниц;</li>
    <li>закрыть подключение к БД (попробуйте не закрывать, посмотрите, что будет, как с этим бороться с точки зрения postgres  <b>(/var/lib/pgsql/data/postgresql.conf)?); </b></li>
    <li>запустить описанный выше алгоритм для данной ссылки. </li>
   </ul>
 <li>6. И так до тех пор, пока глубина вызова не достигнет 6. Для отладки сделать 2
(там очень много вызовов получится, это рекурсия)</li>
 <li>7. Выйти из функции. </li>
</ul>
<p></p>
<b><h3>Структура таблиц (не изменять) :</h3> </b>
<b><h5>Таблица страниц:</h5> </b>
<p>id(PK) </p>
<p>URL</p>
<p>request_depth </p>
<p></p>
<b><h5>Таблица связей:</h5> </b>
<p>from_page_id(FK) </p>
<p>таблица страниц.id (PK) </p>
<p>link_id(FK) </p>
<p>таблица страниц.id(PK) </p>
<p></p>
<p>Для облегчения работы с БД предлагаю освоить ORM SQLAlchemy, но использовать </p>
<p>psycopg2.cursor и чистый SQLне возбраняется. Использовать Postgres - не</p>
<p>бязательно, можно обойтись и sqlite.</p>
<p></p>
<b><h3>Литература и примеры:</h3> </b>
<p>Асинхронные запросы</p>
 <a><p>https://pawelmhm.github.io/asyncio/python/aiohttp/2016/04/22/asyncio-aiohttp.html</p> </a>
 <p></p>
 <p>sqlalchemy</p>
<a><p>https://www.sqlalchemy.org/</p> </a>
<a><p>https://docs.sqlalchemy.org/en/latest/orm/extensions/declarative/basic_use.html</p> </a>
<a><p>https://docs.sqlalchemy.org/en/latest/orm/extensions/declarative/basic_use.html#accessin</p> </a>
 <p></p>
 <p>sg-the-metadata</p>
<a><p>https://www.sqlalchemy.org/</p> </a>
 <p></p>
 <p>Результат разместить в публичном репозитории.</p>
